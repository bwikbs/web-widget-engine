<html>
<script>
function runTest() {
    if (window.testRunner) {
        testRunner.dumpAsText();
        testRunner.waitUntilDone();
    }

    var s = document.createElement('script');
    // s.setAttribute('onload', 'alert("Script onload handler called!"); if (window.testRunner) testRunner.notifyDone()');
    s.setAttribute('onload', 'console.log("PASS"); if (window.testRunner) testRunner.notifyDone(); wpt_test_end();');
    s.id = "theScript";
    s.src = "resources/script-element-gc.js";
    
    document.body.appendChild(s);
}
function wpt_test_end()
{
    try {
        wptTestEnd();
    } catch(e) {
        console.log(e);
    }
}
</script>
<body onload="runTest()">
    This tests that removing the script element from the script loaded by the element itself, and then garbage collecting does not cause a crash when dispatching the onload element (because the script element was freed).
    <p>SUCCESS! Didn't Crash!</p>
</body>
</html>
