<!DOCTYPE html>
<html>
	<head>
                <meta name="viewport" content="width=device-width, user-scalable=no">
		<meta charset="utf-8"/>
		<style>
		* {
			margin: 0;
			padding: 0;
		}

		body {
		    position: absolute;
			width: 360px;
			height: 360px;
		    font-size: 2.125em;
		    color: white;
			background-color: black;
		}

		#box {
			display: block;
			margin-top: 40px;
			padding-left: 30px;
			padding-right: 30px;
		}

		.wrapper_inlineBlock {
                        position: relative;
			display: inline-block;
			width: 48%;
			text-align: center;
            position: relative;
		}

		.img_text {
			text-align: center;
		    font-size: 50px;
		    font-weight: bold;
		    margin-top: -90px;
		}

		.plus_text {
			display: block;
			text-align: center;
			font-size: 90px;
			font-weight: 700;
			margin-top: 20px;
                        position: relative;
                        z-index: 2;
		}

		.plus_text:active {
			color: gray;
		}

		img {
			width:100%;
		}

		#img_coffee {
			margin-left: 10px;
		}

		#img_coffee_tag {
			margin-left:-6px;
		}

                #water_top {
                        display: none;
                        position: absolute;
                        left: 36px;
                        top: 50px;
                        width: 71px;
                        overflow: hidden;
                        text-align: left;
                }

                #img_water_top {
                        width: 250%;
                        height: 16px;
                }

                #coffee_top {
                        display: none;
                        position: absolute;
                        left: 32px;
                        top: 64px;
                        width: 80px;
                        overflow: hidden;
                        text-align: left;
                }

                #img_coffee_top {
                        width: 250%;
                        height: 16px;
                }

                .plus_wrapper {
                        position: relative;
                 }
                 .effect { display:none;
                        position: absolute; text-align:center; z-index: 1;
                        width: 100%; height: 100%; left: 0; top: 0;
                 }
                 .effect_img {
                        width: initial; height: 100%;
                 }
		</style>
	</head>
	<body>
	    <div id="box"> 
	        <div id="water_area" class="wrapper_inlineBlock">
	    		<img id="img_water" src="images/water0.png">
                        <div id="water_top"><img id="img_water_top" src="images/water_top.png"></div>
	    		<div class="img_text" id="img_water_tag">1</div>
                        <div class="plus_wrapper" id="plus_wrapper_water">
	    		     <div class="plus_text" id="plus_water"> + </div>
                             <div class="effect" id="effect_water"><img class="effect_img" src="./images/btn_back.png"></div>
                        </div>
	    	</div>
	    	<div id="coffee_area" class="wrapper_inlineBlock">
	    		<img id="img_coffee" src="images/coffee0.png">
                        <div id="coffee_top"><img id="img_coffee_top" src="images/coffee_top.png"></div>
	    		<div class="img_text" id="img_coffee_tag">2</div>
                        <div class="plus_wrapper" id="plus_wrapper_coffee">
	    		     <div class="plus_text" id="plus_coffee"> + </div>
                             <div class="effect" id="effect_coffee"><img class="effect_img" src="./images/btn_back.png"></div>
                        </div>
	    	</div>
	    </div>
	</body>
	<script>

	var anim = function(kind, max_scene) {
		this.IMG_MAX = max_scene;
		this.imgElement = document.getElementById("img_" + kind);
		this.textElement = document.getElementById("img_" + kind + "_tag");
                this.topElement = document.getElementById("img_" + kind+"_top");
                this.effectElement = document.getElementById("effect_"+kind)
                this.wElement = document.getElementById("plus_wrapper_"+kind)
		this.currentIndex = 0;
		this.animing = false;
		this.forceStop = false;
                this.startX = -110
                this.opa = 1;
                this.tX = this.startX
		this.goAnim = function() {
                        if(this.tX > 210) {
                            this.tX = this.startX; this.opa = 1;
                            this.topElement.parentElement.style.display = "none"
                            this.effectElement.style.display="none"
                            this.wElement.style.transform=""
                            return;
                        }
                        this.effectElement.style.display = "block"
                        this.topElement.parentElement.style.display = "block"
                        this.topElement.style.transform = "translateX("+this.tX+"%)"
                        this.effectElement.style.opacity=this.opa;
                        this.effectElement.style.transform="scale("+(1-this.opa)+")"
                        this.wElement.style.transform = "translateY(" + -20*Math.sin(Math.PI * (1-this.opa)) +"px)"
                        this.tX+=8;
                        this.opa-=0.025;
                        var b = this.goAnim.bind(this)
                        window.requestAnimationFrame(b)
/*
			if (this.animing) {
				if (this.currentIndex > (this.IMG_MAX / 2)) this.currentIndex = 0;
			} else {
				this.animing = true;
				var that = this;
				var nextscene = requestAnimationFrame.bind(undefined, function() {
					if (that.forceStop || that.currentIndex == that.IMG_MAX) {
						that.forceStop = false;
						that.animing = false;
						that.currentIndex = 0;
						that.imgElement.src = "images/" + kind + "0.png";
						return;
					}
					that.currentIndex++;
					that.imgElement.src = "images/" + kind + that.currentIndex + ".png";
					nextscene();
					// console.log("hello");
				});
				nextscene();
			}*/
		};
		document.getElementById(kind + "_area").onclick = function(event) {
			this.goAnim();
			this.textElement.textContent = parseInt(this.textElement.textContent) + 1;
		}.bind(this);
	};

	var water = new anim("water");
	var coffee = new anim("coffee");
	</script>
</html>
