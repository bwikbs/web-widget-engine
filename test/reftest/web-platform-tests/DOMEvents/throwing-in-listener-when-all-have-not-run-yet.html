<!DOCTYPE html>
<meta charset="UTF-8">
<title>Throwing in event listener</title>

<script src="../resources/testharness.js"></script>
<script src="../resources/testharnessreport.js"></script>
<body><div id="log"></div></body>

<script>
    setup({allow_uncaught_exception:true})
    var t = async_test("Throwing in event listener");

    document.body.onload = t.step_func(function(){
        var element = document.getElementById('bim');

        var secondCalled = false;

        element.addEventListener('click', function(){
            throw new Error('Error from listener');
        });
        element.addEventListener('click', t.step_func(function(){ secondCalled = true; }), false);

        element.click();

        assert_true(secondCalled);
        t.done();
    });
</script>

<div id="bim">
</div>
